{"version":3,"file":"xlsx.js","names":["getCells","document","worksheet","documentElement","sheetData","findChild","cells","forEach","row","cell","push","getMergedCells","mergedCells","mergedCellsInfo","mergedCell","getAttribute","getCellValue","node","getCellInlineStringValue","firstChild","getTagName","textContent","getDimensions","dimensions","getBaseStyles","styleSheet","cellStyleXfs","findChildren","getCellStyles","cellXfs","getNumberFormats","numberFormats","numFmts","getSharedStrings","sst","map","string","t","value","r","getWorkbookProperties","workbook","getRelationships","relationships","getSheets","sheets"],"sources":["../../source/xml/xlsx.js"],"sourcesContent":["import { findChild, findChildren, forEach, map, getTagName } from './dom.js'\r\n\r\nexport function getCells(document) {\r\n  const worksheet = document.documentElement\r\n  const sheetData = findChild(worksheet, 'sheetData')\r\n\r\n  const cells = []\r\n  forEach(sheetData, 'row', (row) => {\r\n    forEach(row, 'c', (cell) => {\r\n      cells.push(cell)\r\n    })\r\n  })\r\n  return cells\r\n}\r\n\r\nexport function getMergedCells(document) {\r\n  const worksheet = document.documentElement\r\n  const mergedCells = findChild(worksheet, 'mergeCells')\r\n  const mergedCellsInfo = []\r\n  if (mergedCells) {\r\n    forEach(mergedCells, 'mergeCell', (mergedCell) => {\r\n      mergedCellsInfo.push(mergedCell.getAttribute('ref'))\r\n    })\r\n  }\r\n  return mergedCellsInfo\r\n}\r\n\r\nexport function getCellValue(document, node) {\r\n  return findChild(node, 'v')\r\n}\r\n\r\nexport function getCellInlineStringValue(document, node) {\r\n  if (\r\n    node.firstChild &&\r\n    getTagName(node.firstChild) === 'is' &&\r\n    node.firstChild.firstChild &&\r\n    getTagName(node.firstChild.firstChild) === 't'\r\n  ) {\r\n    return node.firstChild.firstChild.textContent\r\n  }\r\n}\r\n\r\nexport function getDimensions(document) {\r\n  const worksheet = document.documentElement\r\n  const dimensions = findChild(worksheet, 'dimension')\r\n  if (dimensions) {\r\n    return dimensions.getAttribute('ref')\r\n  }\r\n}\r\n\r\nexport function getBaseStyles(document) {\r\n  const styleSheet = document.documentElement\r\n  const cellStyleXfs = findChild(styleSheet, 'cellStyleXfs')\r\n  if (cellStyleXfs) {\r\n    return findChildren(cellStyleXfs, 'xf')\r\n  }\r\n  return []\r\n}\r\n\r\nexport function getCellStyles(document) {\r\n  const styleSheet = document.documentElement\r\n  const cellXfs = findChild(styleSheet, 'cellXfs')\r\n  if (!cellXfs) {\r\n    return []\r\n  }\r\n  return findChildren(cellXfs, 'xf')\r\n}\r\n\r\nexport function getNumberFormats(document) {\r\n  const styleSheet = document.documentElement\r\n  let numberFormats = []\r\n  const numFmts = findChild(styleSheet, 'numFmts')\r\n  if (numFmts) {\r\n    return findChildren(numFmts, 'numFmt')\r\n  }\r\n  return []\r\n}\r\n\r\nexport function getSharedStrings(document) {\r\n\t// An `<si/>` element can contain a `<t/>` (simplest case) or a set of `<r/>` (\"rich formatting\") elements having `<t/>`.\r\n\t// https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.sharedstringitem?redirectedfrom=MSDN&view=openxml-2.8.1\r\n\t// http://www.datypic.com/sc/ooxml/e-ssml_si-1.html\r\n\r\n  const sst = document.documentElement\r\n  return map(sst, 'si', string => {\r\n    const t = findChild(string, 't')\r\n    if (t) {\r\n      return t.textContent\r\n    }\r\n    let value = ''\r\n    forEach(string, 'r', (r) => {\r\n      value += findChild(r, 't').textContent\r\n    })\r\n    return value\r\n  })\r\n}\r\n\r\nexport function getWorkbookProperties(document) {\r\n  const workbook = document.documentElement\r\n  return findChild(workbook, 'workbookPr')\r\n}\r\n\r\nexport function getRelationships(document) {\r\n  const relationships = document.documentElement\r\n  return findChildren(relationships, 'Relationship')\r\n}\r\n\r\nexport function getSheets(document) {\r\n  const workbook = document.documentElement\r\n  const sheets = findChild(workbook, 'sheets')\r\n  return findChildren(sheets, 'sheet')\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AAEO,SAASA,QAAT,CAAkBC,QAAlB,EAA4B;EACjC,IAAMC,SAAS,GAAGD,QAAQ,CAACE,eAA3B;EACA,IAAMC,SAAS,GAAG,IAAAC,cAAA,EAAUH,SAAV,EAAqB,WAArB,CAAlB;EAEA,IAAMI,KAAK,GAAG,EAAd;EACA,IAAAC,YAAA,EAAQH,SAAR,EAAmB,KAAnB,EAA0B,UAACI,GAAD,EAAS;IACjC,IAAAD,YAAA,EAAQC,GAAR,EAAa,GAAb,EAAkB,UAACC,IAAD,EAAU;MAC1BH,KAAK,CAACI,IAAN,CAAWD,IAAX;IACD,CAFD;EAGD,CAJD;EAKA,OAAOH,KAAP;AACD;;AAEM,SAASK,cAAT,CAAwBV,QAAxB,EAAkC;EACvC,IAAMC,SAAS,GAAGD,QAAQ,CAACE,eAA3B;EACA,IAAMS,WAAW,GAAG,IAAAP,cAAA,EAAUH,SAAV,EAAqB,YAArB,CAApB;EACA,IAAMW,eAAe,GAAG,EAAxB;;EACA,IAAID,WAAJ,EAAiB;IACf,IAAAL,YAAA,EAAQK,WAAR,EAAqB,WAArB,EAAkC,UAACE,UAAD,EAAgB;MAChDD,eAAe,CAACH,IAAhB,CAAqBI,UAAU,CAACC,YAAX,CAAwB,KAAxB,CAArB;IACD,CAFD;EAGD;;EACD,OAAOF,eAAP;AACD;;AAEM,SAASG,YAAT,CAAsBf,QAAtB,EAAgCgB,IAAhC,EAAsC;EAC3C,OAAO,IAAAZ,cAAA,EAAUY,IAAV,EAAgB,GAAhB,CAAP;AACD;;AAEM,SAASC,wBAAT,CAAkCjB,QAAlC,EAA4CgB,IAA5C,EAAkD;EACvD,IACEA,IAAI,CAACE,UAAL,IACA,IAAAC,eAAA,EAAWH,IAAI,CAACE,UAAhB,MAAgC,IADhC,IAEAF,IAAI,CAACE,UAAL,CAAgBA,UAFhB,IAGA,IAAAC,eAAA,EAAWH,IAAI,CAACE,UAAL,CAAgBA,UAA3B,MAA2C,GAJ7C,EAKE;IACA,OAAOF,IAAI,CAACE,UAAL,CAAgBA,UAAhB,CAA2BE,WAAlC;EACD;AACF;;AAEM,SAASC,aAAT,CAAuBrB,QAAvB,EAAiC;EACtC,IAAMC,SAAS,GAAGD,QAAQ,CAACE,eAA3B;EACA,IAAMoB,UAAU,GAAG,IAAAlB,cAAA,EAAUH,SAAV,EAAqB,WAArB,CAAnB;;EACA,IAAIqB,UAAJ,EAAgB;IACd,OAAOA,UAAU,CAACR,YAAX,CAAwB,KAAxB,CAAP;EACD;AACF;;AAEM,SAASS,aAAT,CAAuBvB,QAAvB,EAAiC;EACtC,IAAMwB,UAAU,GAAGxB,QAAQ,CAACE,eAA5B;EACA,IAAMuB,YAAY,GAAG,IAAArB,cAAA,EAAUoB,UAAV,EAAsB,cAAtB,CAArB;;EACA,IAAIC,YAAJ,EAAkB;IAChB,OAAO,IAAAC,iBAAA,EAAaD,YAAb,EAA2B,IAA3B,CAAP;EACD;;EACD,OAAO,EAAP;AACD;;AAEM,SAASE,aAAT,CAAuB3B,QAAvB,EAAiC;EACtC,IAAMwB,UAAU,GAAGxB,QAAQ,CAACE,eAA5B;EACA,IAAM0B,OAAO,GAAG,IAAAxB,cAAA,EAAUoB,UAAV,EAAsB,SAAtB,CAAhB;;EACA,IAAI,CAACI,OAAL,EAAc;IACZ,OAAO,EAAP;EACD;;EACD,OAAO,IAAAF,iBAAA,EAAaE,OAAb,EAAsB,IAAtB,CAAP;AACD;;AAEM,SAASC,gBAAT,CAA0B7B,QAA1B,EAAoC;EACzC,IAAMwB,UAAU,GAAGxB,QAAQ,CAACE,eAA5B;EACA,IAAI4B,aAAa,GAAG,EAApB;EACA,IAAMC,OAAO,GAAG,IAAA3B,cAAA,EAAUoB,UAAV,EAAsB,SAAtB,CAAhB;;EACA,IAAIO,OAAJ,EAAa;IACX,OAAO,IAAAL,iBAAA,EAAaK,OAAb,EAAsB,QAAtB,CAAP;EACD;;EACD,OAAO,EAAP;AACD;;AAEM,SAASC,gBAAT,CAA0BhC,QAA1B,EAAoC;EAC1C;EACA;EACA;EAEC,IAAMiC,GAAG,GAAGjC,QAAQ,CAACE,eAArB;EACA,OAAO,IAAAgC,QAAA,EAAID,GAAJ,EAAS,IAAT,EAAe,UAAAE,MAAM,EAAI;IAC9B,IAAMC,CAAC,GAAG,IAAAhC,cAAA,EAAU+B,MAAV,EAAkB,GAAlB,CAAV;;IACA,IAAIC,CAAJ,EAAO;MACL,OAAOA,CAAC,CAAChB,WAAT;IACD;;IACD,IAAIiB,KAAK,GAAG,EAAZ;IACA,IAAA/B,YAAA,EAAQ6B,MAAR,EAAgB,GAAhB,EAAqB,UAACG,CAAD,EAAO;MAC1BD,KAAK,IAAI,IAAAjC,cAAA,EAAUkC,CAAV,EAAa,GAAb,EAAkBlB,WAA3B;IACD,CAFD;IAGA,OAAOiB,KAAP;EACD,CAVM,CAAP;AAWD;;AAEM,SAASE,qBAAT,CAA+BvC,QAA/B,EAAyC;EAC9C,IAAMwC,QAAQ,GAAGxC,QAAQ,CAACE,eAA1B;EACA,OAAO,IAAAE,cAAA,EAAUoC,QAAV,EAAoB,YAApB,CAAP;AACD;;AAEM,SAASC,gBAAT,CAA0BzC,QAA1B,EAAoC;EACzC,IAAM0C,aAAa,GAAG1C,QAAQ,CAACE,eAA/B;EACA,OAAO,IAAAwB,iBAAA,EAAagB,aAAb,EAA4B,cAA5B,CAAP;AACD;;AAEM,SAASC,SAAT,CAAmB3C,QAAnB,EAA6B;EAClC,IAAMwC,QAAQ,GAAGxC,QAAQ,CAACE,eAA1B;EACA,IAAM0C,MAAM,GAAG,IAAAxC,cAAA,EAAUoC,QAAV,EAAoB,QAApB,CAAf;EACA,OAAO,IAAAd,iBAAA,EAAakB,MAAb,EAAqB,OAArB,CAAP;AACD"}